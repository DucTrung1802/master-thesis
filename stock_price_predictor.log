2024-12-29 17:44:41,787 - INFO - SqlServerDriver - __init__ - Start to connect to SQL Server.
2024-12-29 17:44:41,809 - INFO - SqlServerDriver - __init__ - Connected to SQL Server.
2024-12-29 17:44:41,809 - DEBUG - SqlServerDriver - check_database_exists - 

            SELECT 
            CASE 
                WHEN EXISTS (SELECT 1 FROM sys.databases WHERE name = 'SSI_STOCKS') 
                THEN 'True' 
                ELSE 'False' 
            END AS Result;
        
2024-12-29 17:44:41,810 - DEBUG - SqlServerDriver - create_new_database - 

            CREATE DATABASE [SSI_STOCKS];
        
2024-12-29 17:44:41,916 - DEBUG - SqlServerDriver - create_new_database - 

            USE [SSI_STOCKS];
        
2024-12-29 17:44:41,916 - INFO - SqlServerDriver - create_new_database - Created database with name "SSI_STOCKS".
2024-12-29 17:44:41,916 - DEBUG - SqlServerDriver - check_database_exists - 

            SELECT 
            CASE 
                WHEN EXISTS (SELECT 1 FROM sys.databases WHERE name = 'SSI_STOCKS') 
                THEN 'True' 
                ELSE 'False' 
            END AS Result;
        
2024-12-29 17:44:41,932 - DEBUG - SqlServerDriver - check_table_exists - 

            SELECT CASE 
                WHEN OBJECT_ID('SSI_STOCKS.dbo.Market', 'U') IS NOT NULL THEN 'True'
                ELSE 'False'
            END AS Result;
        
2024-12-29 17:44:41,933 - DEBUG - SqlServerDriver - create_table - 
USE SSI_STOCKS;
            
CREATE TABLE Market (
    ID INT IDENTITY(1,1) PRIMARY KEY NOT NULL,
    Symbol NVARCHAR(5) NOT NULL,
	Name NVARCHAR(200) NOT NULL,
	EnName NVARCHAR(200) NOT NULL,
	CreateDate DATETIME NOT NULL,
	UpdateDate DATETIME NULL,
	DeleteDate DATETIME NULL
);
2024-12-29 17:44:41,940 - INFO - SqlServerDriver - create_table - Table 'SSI_STOCKS.dbo.Market' is created successfully.
2024-12-29 17:44:41,940 - DEBUG - SqlServerDriver - check_database_exists - 

            SELECT 
            CASE 
                WHEN EXISTS (SELECT 1 FROM sys.databases WHERE name = 'SSI_STOCKS') 
                THEN 'True' 
                ELSE 'False' 
            END AS Result;
        
2024-12-29 17:44:41,941 - DEBUG - SqlServerDriver - check_table_exists - 

            SELECT CASE 
                WHEN OBJECT_ID('SSI_STOCKS.dbo.SecurityType', 'U') IS NOT NULL THEN 'True'
                ELSE 'False'
            END AS Result;
        
2024-12-29 17:44:41,943 - DEBUG - SqlServerDriver - create_table - 
USE SSI_STOCKS;
            
CREATE TABLE SecurityType (
    ID INT IDENTITY(1,1) PRIMARY KEY NOT NULL,
    Symbol NVARCHAR(2) NOT NULL,
	Name NVARCHAR(30) NOT NULL,
	CreateDate DATETIME NOT NULL,
	UpdateDate DATETIME NULL,
	DeleteDate DATETIME NULL
);
2024-12-29 17:44:41,945 - INFO - SqlServerDriver - create_table - Table 'SSI_STOCKS.dbo.SecurityType' is created successfully.
2024-12-29 17:44:41,945 - DEBUG - SqlServerDriver - check_database_exists - 

            SELECT 
            CASE 
                WHEN EXISTS (SELECT 1 FROM sys.databases WHERE name = 'SSI_STOCKS') 
                THEN 'True' 
                ELSE 'False' 
            END AS Result;
        
2024-12-29 17:44:41,945 - DEBUG - SqlServerDriver - check_table_exists - 

            SELECT CASE 
                WHEN OBJECT_ID('SSI_STOCKS.dbo.Security', 'U') IS NOT NULL THEN 'True'
                ELSE 'False'
            END AS Result;
        
2024-12-29 17:44:41,945 - DEBUG - SqlServerDriver - check_table_exists - 

            SELECT CASE 
                WHEN OBJECT_ID('SSI_STOCKS.dbo.Market', 'U') IS NOT NULL THEN 'True'
                ELSE 'False'
            END AS Result;
        
2024-12-29 17:44:41,945 - DEBUG - SqlServerDriver - check_table_exists - 

            SELECT CASE 
                WHEN OBJECT_ID('SSI_STOCKS.dbo.SecurityType', 'U') IS NOT NULL THEN 'True'
                ELSE 'False'
            END AS Result;
        
2024-12-29 17:44:41,945 - DEBUG - SqlServerDriver - create_table - 
USE SSI_STOCKS;
            
CREATE TABLE Security (
    ID INT IDENTITY(1,1) PRIMARY KEY NOT NULL,
    Symbol NVARCHAR(12) NOT NULL,
	Name NVARCHAR(200) NOT NULL,
	EnName NVARCHAR(200) NOT NULL,
	ListedShare BIGINT NOT NULL,
	MarketCapitalization BIGINT NOT NULL,
	Market_ID INT NOT NULL,
	SecurityType_ID INT NOT NULL,
	CreateDate DATETIME NOT NULL,
	UpdateDate DATETIME NULL,
	DeleteDate DATETIME NULL
    FOREIGN KEY (Market_ID) REFERENCES Market(ID),
	FOREIGN KEY (SecurityType_ID) REFERENCES SecurityType(ID)
);
2024-12-29 17:44:41,950 - INFO - SqlServerDriver - create_table - Table 'SSI_STOCKS.dbo.Security' is created successfully.
2024-12-29 17:44:41,950 - DEBUG - SqlServerDriver - check_database_exists - 

            SELECT 
            CASE 
                WHEN EXISTS (SELECT 1 FROM sys.databases WHERE name = 'SSI_STOCKS') 
                THEN 'True' 
                ELSE 'False' 
            END AS Result;
        
2024-12-29 17:44:41,950 - DEBUG - SqlServerDriver - check_table_exists - 

            SELECT CASE 
                WHEN OBJECT_ID('SSI_STOCKS.dbo.Market', 'U') IS NOT NULL THEN 'True'
                ELSE 'False'
            END AS Result;
        
2024-12-29 17:44:41,951 - DEBUG - SqlServerDriver - insert_data - 
INSERT INTO [SSI_STOCKS].[dbo].[Market]
(
    [Symbol],
	[Name],
	[EnName],
	[CreateDate]
)
VALUES
(
    N'HNX',
	N'Sở Giao dịch Chứng khoán Hà Nội',
	N'Hanoi Stock Exchange',
	CAST ('2024-12-29 17:44:41' AS DATETIME)
)

